<!DOCTYPE html>
<html>
<head>
    <title>Locust</title>
    <link rel="stylesheet" type="text/css" href="/static/style.css?v={{ version }}" media="screen">
    <link rel="shortcut icon" href="/static/img/favicon.ico" type="image/x-icon"/>
    <link rel="stylesheet" href="/static/select2-bootstrap.min.css"/>
    <link rel="stylesheet" href="/static/select2.css"/>
</head>
<body class="{{state}}">
    <div class="top">
        <div class="top-content container">
            <img src="/static/img/logo.png?v={{ version }}" class="logo" />
            <div class="boxes">
                <div class="top_box box_url">
                    <div class="label">HOST</div>
                    <div class="value" id="host_url">
                        {{host}}
                    </div>
                    <a href="#" class="edit_test">Edit</a>
                    <a href="#" class="new_test" id="new_test">New Test</a>
                    {% if ramp %}
                        <a href="#" class="new_test ramp_test">New Ramp</a>
                    {% endif %}
                </div>
                <div class="top_box box_status">
                    <div class="label">STATUS</div>
                    <div class="value" id="status_text">
                        {{state}}
                    </div>
                    <div class="user_count">
                        <span id="userCount">{{user_count}}</span> users
                    </div>
                </div>
                {% if is_distributed %}
                    <div class="top_box box_slaves" id="box_rps">
                        <div class="label">SLAVES</div>
                        <div class="value" id="slaveCount">{{slave_count}}</div>
                    </div>
                {% endif %}
                <div class="top_box box_rps box_running" id="box_rps">
                    <div class="label">RPS</div>
                    <div class="value" id="total_rps">0</div>
                </div>
                <div class="top_box box_fail box_running" id="box_fail">
                    <div class="label">FAILURES</div>
                    <div class="value"><span id="fail_ratio"></span>%</div>
                </div>
                 <div class="top_box box_run_time box_running" id="box_run_time">
                    <div class="label">RUN TIME</div>
                    <div class="value"><span id="run_time"></span>{{ run_time }}</div>
                </div>
                <div class="top_box box_stop box_running" id="box_stop">
                    <a href="/stop" class="stop-button stop-timer"><i></i>STOP</a>
                    <a href="/stats/reset" class="reset-button">Reset<br>Stats</a>
                </div>
            </div>
            <div style="clear:both;"></div>
        </div>
    </div>
    <div class="main">
        <div class="start" id="start">
            <div style="position:relative;">
                <a href="#" class="close_link">Close</a>
            </div>
            <div class="padder">
                <h2>Start new Locust swarm</h2>
                <form action="/swarm" method="POST" id="swarm_form" class="start-timer">
                    <label for="locust_count">Number of users to simulate</label>
                    <input type="text" name="locust_count" id="locust_count" class="val" /><br>
                    <label for="hatch_rate">Hatch rate <span style="color:#8a8a8a;">(users spawned/second)</span></label>
                    <input type="text" name="hatch_rate" id="hatch_rate" class="val" /><br>
                    <label for="locustfile">Locust file to execute</label>
                    <select name="locustfile" id="locustfile" class="select2">
                        {% for name in available_locustfiles %}
                            <option value="{{name}}">{{name}}</option>
                        {% endfor %}
                    </select>
                    <br><br>
                    <a href="#" class="edit_config_json">Edit Config</a>
                    <button type="submit">Start swarming</button>
                </form>
                <div style="clear:right;"></div>
            </div>
            <br>
            <div class="ramp_text">
            {% if ramp %}

                ...or let locust <a href="#" class="ramp_test">ramp</a> find the highest stable locust count for you
            {% endif %}
            </div>
        </div>

        <div class="edit" id="edit">
            <div style="position:relative;">
                <a href="#" class="close_link">Close</a>
            </div>
            <div class="padder">
                <h2>Change the locust count</h2>
                <form action="/swarm" method="POST" id="edit_form">
                    <label for="locust_count">Number of users to simulate</label>
                    <input type="text" name="locust_count" id="new_locust_count" class="val" /><br>
                    <label for="hatch_rate">Hatch rate <span style="color:#8a8a8a;">(users spawned/second)</span></label>
                    <input type="text" name="hatch_rate" id="new_hatch_rate" class="val" /><br>
                    <button type="submit">Start swarming</button>
                </form>
                <div style="clear:right;"></div>
            </div>
        </div>

        {% if ramp %}
            <div class="start ramp" id="ramp">
                <div style="position:relative;">
                    <a href="#" class="close_link">Close</a>
                </div>
                <div class="padder">
                    <h2>Ramping</h2>
                    <form action="/ramp" method="POST" id="ramp_form" class="start-timer">
                        <div style="float:left;">
                        <label for="init_count" title="This is the number of initial number of locusts that will be spawned. Pick a number you know can be handled.">Initial number of clients</label>
                        <input type="text" name="init_count" id="init_count" class="val" /><br>
                        <label for="hatch_rate" title="This is the rate locusts/second at which all slaves together will spawn additional locusts">Hatch rate <span style="color:#8a8a8a;">(users spawned/second)</span></label>
                        <input type="text" name="hatch_rate" id="hatch_rate" class="val" /><br>
                        <label for="hatch_stride" title="This is the amount of locusts that will be spawned in between each sleep (calibration)">Hatch stride</label>
                        <input type="text" name="hatch_stride" id="hatch_stride" class="val" /><br>
                        <label for="precision" title="Hatchstride will lower when a threshold has been reached and when hachstride <= precision; the sweet spot has been found">Precision (min value of hatch stride)</label>
                        <input type="text" name="precision" id="precision" class="val" /><br>
                        <label for="wait_time" title="The amount of time to sleep to gather enough statistics before checking for thresholds">Calibration time (seconds)</label>
                        <input type="text" name="wait_time" id="wait_time" class="val" value="20" /><br>
                        </div>
                        <div style="float:right;">
                        <label for="max_count" title="This is a threshold, if exceeded we start ramping down">Max number of clients</label>
                        <input type="text" name="max_count" id="max_count" class="val" /><br>
                        <label for="percentile" title="Threshold - The percentage of all responses that has to be have response times lower than a set limit.">Percentile (%)</label>
                        <input type="text" name="percentile" id="percentile" class="val" value="95" /><br>
                        <label for="response_time" title="Threshold - The highest response time that a percentage of all responses must not exceed.">Max percentile response time (ms)</label>
                        <input type="text" name="response_time" id="response_time" class="val" value="2000" /><br>
                        <label for="fail_rate" title="This threshold is the highest ratio in percent of all requests that are allowed to fail.">Accepted fail ratio (%)</label>
                        <input type="text" name="fail_rate" id="fail_rate" class="val" value="5" /><br>
                        <br>
                        <a href="#" class="edit_config_json">Edit Config</a>
                        <br><br><br>
                        <input type="image" src="/static/img/start_button.png" value="Start swarming" class="start_button">
                        </div>

                    </form>
                    <div style="clear:right;"></div>
                </div>
            </div>
        {% endif %}

        <div class="edit_config" id="edit_config" style="display:none;">
            <div class="title_header">
                <div class="container">JSON Configuration</div>
            </div>
            <nav id="menu_json" class="menu_json">
                <ul class="tabs_json container">
                    <li id="simple_tab" class="simple_tab"><a href="#">Simple</a></li>
                    <!-- <li><a href="#">Advance</a></li> -->
                    <li class="back_new_test" style="float:right"><a href="#">New Test</a></li>
                    {% if ramp %}
                    <li class="ramp_test" style="float:right"><a href="#">New Ramp</a></li>
                    {%endif%}
                </ul>
            </nav>
            <div id="panes_json" class="panes_json container_json">
                <div id="json_editor" style="display:none;">
                    <div class="custom_padder">
                        <label>Import CSV</label>
                        <form method="POST" enctype="multipart/form-data" id="upload_csv">
                            <input type="file" name="csv_file" id="csv_file"/>
                            <input type="submit" value="Upload" id="btnSubmit" />
                        </form>
                        <br>
                        <label>Configuration</label>
                        <form action="/config/json" method="POST" id="edit_config_form">
                            <textarea name="config_json" id="config_json">{{json_config}}</textarea>
                            <button type="submit" onClick="window.location.reload()">Save</button>
                        </form>
                        <div style="clear:right;"></div>
                    </div>
                </div>
                <div id="json_creator" style="display:none;">
                    hello
                </div>
            </div> 
        </div>

        <div class="multiple_column" id="multiple_column">
            <div style="position:relative;">
                <a href="#" class="close_link_headers">Close</a>
            </div>
            <br>
            <div class="padder">
                <h2>Pick the multiple data from header list</h2>
                <form action="/config/convert" method="POST" id="multiple_column_form">
                    <div class="modal_multiple_column">
                        <ul id="column_header" class="column_header"></ul>
                    </div>
                    <br>
                    <label for="JSON Path" title="This is JSON Path input">JSON Path</label>
                    <br>
                    <input type="text" name="jsonpath" id="jsonpath" class="val" /><br>
                    <br>
                    <input type="radio" name="json_option" id="json_option" value="replace">Replace<br>
                    <input type="radio" name="json_option" id="json_option" value="write_below">Write Below<br>
                    <button type="submit">Convert</button>
                </form>
                <div style="clear:right;"></div>
            </div>
        </div>
        

        <div class="status" id="status">
            <nav class="menu">
                <ul class="tabs container">
                    <li><a href="#">Statistics</a></li>
                    <li><a href="#" class="chart-tab-link">Charts</a></li>
                    <li><a href="#">Failures</a></li>
                    <li><a href="#">Exceptions</a></li>
                    <li><a href="#">Download Data</a></li>
                </ul>
            </nav>
            <div class="panes container">
                <div style="display:none;">
                    <table id="stats" class="stats">
                        <thead>
                            <tr>
                                <th class="stats_label" href="#" data-sortkey="method">Type</th>
                                <th class="stats_label" href="#" data-sortkey="name">Name</th>
                                <th class="stats_label numeric" href="#" data-sortkey="num_requests" title="Number of successful requests"># requests</th>
                                <th class="stats_label numeric" href="#" data-sortkey="num_failures" title="Number of failures"># fails</th>
                                <th class="stats_label numeric" href="#" data-sortkey="median_response_time" title="Median response time">Median (ms)</th>
                                <th class="stats_label numeric" href="#" data-sortkey="avg_response_time" title="Average response time">Average (ms)</th>
                                <th class="stats_label numeric" href="#" data-sortkey="min_response_time" title="Min response time">Min (ms)</th>
                                <th class="stats_label numeric" href="#" data-sortkey="max_response_time" title="Max response time">Max (ms)</th>
                                <th class="stats_label numeric" href="#" data-sortkey="avg_content_length" title="Average response size">Content Size</th>
                                <th class="stats_label numeric" href="#" data-sortkey="current_rps" title="Current number of requests per second"># reqs/sec</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
                <div id="charts" style="display:none;">
                    <p class="note">Note: There is no persistence of these charts, if you refresh this page, new charts will be created.</p>
                    <div class="charts-container"></div>
                </div>
                <div style="display:none;">
                    <table id="errors" class="stats">
                        <thead>
                            <th class="error_count stats_label" data-sortkey="1"># fails</th>
                            <th class="stats_label" href="#" data-sortkey="method">Method</th>
                            <th class="stats_label" href="#" data-sortkey="name">Name</th>
                            <th class="error_type stats_label" data-sortkey="0">Type</th>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
                <div style="display:none;">
                    <table id="exceptions" class="stats">
                        <thead>
                            <th class="exception_occurences stats_label" data-sortkey="1"># occurences</th>
                            <th class="exception_traceback stats_label" data-sortkey="0">Traceback</th>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
                <div style="display:none;">
                    <div style="margin-top:20px;">
                        <a href="/stats/requests/csv">Download request statistics CSV</a><br>
                        <a href="/stats/distribution/csv">Download response time distribution CSV</a><br>
                        <a href="/exceptions/csv">Download exceptions CSV</a>
                    </div>
                </div>
            </div>
        </div>

        <div class="about" style="display:none;">
            <div style="position:relative;">
                <a href="#" class="close_link">Close</a>
            </div>
            <div class="padder">
                <h1>About</h1>
                <p>
                    The original idea for Locust was Carl Byström's who made a first proof of concept in June 2010.
                    Jonatan Heyman picked up Locust in January 2011, implemented the current concept of Locust classes
                    and made it work distributed across multiple machines.
                </p>
                <p>
                    Jonatan, Carl and Joakim Hamrén has continued the development of Locust at their job,
                    ESN Social Software, who have adopted Locust as an inhouse Open Source project.
                </p>

                <h1>Authors and Copyright</h1>
                <a href="http://cgbystrom.com/">Carl Byström</a> (<a href="http://twitter.com/cgbystrom/">@cgbystrom</a>)<br>
                <a href="http://heyman.info/">Jonatan Heyman</a> (<a href="http://twitter.com/jonatanheyman/">@jonatanheyman</a>)<br>
                Joakim Hamrén (<a href="http://twitter.com/Jahaaja/">@jahaaja</a>)<br>
                <a href="http://esn.me/">ESN Social Software</a> (<a href="http://twitter.com/uprise_ea/">@uprise_ea</a>)<br>
                Hugo Heyman (<a href="http://twitter.com/hugoheyman/">@hugoheyman</a>)


                <h1>License</h1>
                Open source licensed under the MIT license.

                <h1>Version</h1>
                {{version}}<br>
                <a href="http://locust.io/">http://locust.io</a>
            </div>
        </div>
    </div>
    <nav class="footer">
        <div class="container">
            <a href="#" onclick="$('.about').fadeIn();">About</a>
        </div>
    </nav>


    <script type="text/javascript" src="/static/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="/static/jquery.jqote2.min.js"></script>
    <script type="text/javascript" src="/static/jquery.tools.min.js"></script>
    <!-- echarts from https://github.com/ecomfe/echarts -->
    <script type="text/javascript" src="/static/echarts.common.min.js"></script>
    <!-- vintage theme of echarts -->
    <script type="text/javascript" src="/static/vintage.js"></script>
    <script type="text/x-jqote-template" id="stats-template">
        <![CDATA[
        <tr class="<%=(alternate ? "dark" : "")%> <%=(this.name == "Total" ? "total" : "")%>">
            <td><%= (this.method ? this.method : "") %></td>
            <td class="name" title="<%= this.name %>"><%= this.name %></td>
            <td class="numeric"><%= this.num_requests %></td>
            <td class="numeric"><%= this.num_failures %></td>
            <td class="numeric"><%= Math.round(this.median_response_time) %></td>
            <td class="numeric"><%= Math.round(this.avg_response_time) %></td>
            <td class="numeric"><%= this.min_response_time %></td>
            <td class="numeric"><%= this.max_response_time %></td>
            <td class="numeric"><%= Math.round(this.avg_content_length) %></td>
            <td class="numeric"><%= Math.round(this.current_rps*100)/100 %></td>
        </tr>
        <% alternate = !alternate; %>
        ]]>
    </script>
    <script type="text/x-jqote-template" id="errors-template">
        <![CDATA[
        <tr class="<%=(alternate ? "dark" : "")%>">
            <td><%= this.occurences %></td>
            <td><%= this.method %></td>
            <td><%= this.name %></td>
            <td><%= function(e) { return e.replace("<", "&lt;"); }(this.error) %></td>
        </tr>
        <% alternate = !alternate; %>
        ]]>
    </script>
    <script type="text/x-jqote-template" id="exceptions-template">
        <![CDATA[
        <tr class="<%=(alternate ? " dark" : "")%>">
        <td class="occurences"><%= this.count %></td>
        <td class="traceback" title="Occured on: <%= this.nodes %>"><%= function(e) { return e.replace("<", "&lt;");
            }(this.traceback) %>
            <%= function(e) { return e.replace("<", "&lt;"); }(this.msg) %>
        </td>
        </tr>
        <% alternate = !alternate; %>
        ]]>
    </script>
    <script type="text/javascript" src="/static/chart.js?v={{ version }}"></script>
    <script type="text/javascript" src="/static/select2.js"></script>
    <script type="text/javascript" src="/static/timer.js"></script>
    <script type="text/javascript" src="/static/locust.js?v={{ version }}"></script>
</body>
</html>
